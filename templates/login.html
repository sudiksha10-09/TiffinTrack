<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Login ‚Äì TiffinTrack</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>

<body>

<!-- NAVBAR -->
<nav class="navbar">
  <div class="nav-container">
    <div class="logo">üç± TiffinTrack</div>
    <div>
      <a href="{{ url_for('home') }}" class="btn-outline">Home</a>
      <a href="{{ url_for('register') }}" class="btn-primary">Create Account</a>
    </div>
  </div>
</nav>

<!-- FLASH MESSAGES -->
<div class="flash-messages">
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for category, message in messages %}
        <div class="flash-message flash-{{ category }}">
          <i class="fas fa-{{ 'check-circle' if category == 'success' else 'exclamation-circle' }}"></i>
          {{ message }}
        </div>
      {% endfor %}
    {% endif %}
  {% endwith %}
</div>

<!-- LOGIN PAGE -->
<section class="hero" style="padding-top: 60px;">
  <div class="hero-grid" style="grid-template-columns: 1fr 1fr;">

    <!-- LEFT BRANDING -->
    <div class="hero-text">
      <span class="badge">Welcome Back</span>
      <h1>Sign in to your account</h1>
      <p>
        Access your personalized dashboard to manage tiffin orders, track deliveries, and control your meal subscriptions with ease.
      </p>

      <div class="trust">
        <div><i class="fas fa-utensils"></i> Fresh Meals Daily</div>
        <div><i class="fas fa-truck"></i> Reliable Delivery</div>
        <div><i class="fas fa-shield-alt"></i> Secure Platform</div>
      </div>
    </div>

    <!-- LOGIN CARD -->
    <div class="card">
      <div style="text-align: center; margin-bottom: 2rem;">
        <h2 style="font-size: 1.8rem; margin-bottom: 0.5rem;">Sign In</h2>
        <p style="color: var(--text-secondary); font-size: 0.9rem;">Enter your credentials to continue</p>
      </div>

      <form method="POST" action="{{ url_for('login') }}" class="space-y-4" id="loginForm">

        <div>
          <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--text-primary);">
            <i class="fas fa-envelope" style="margin-right: 8px; color: var(--primary);"></i>
            Email Address
          </label>
          <input
            type="email"
            name="email"
            class="input"
            placeholder="Enter your email"
            required
            autocomplete="email"
          >
        </div>

        <div>
          <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--text-primary);">
            <i class="fas fa-lock" style="margin-right: 8px; color: var(--primary);"></i>
            Password
          </label>
          <div style="position: relative;">
            <input
              type="password"
              id="password"
              name="password"
              class="input"
              placeholder="Enter your password"
              required
              autocomplete="current-password"
            >
            <button 
              type="button" 
              onclick="togglePassword('password', this)"
              style="position: absolute; right: 12px; top: 50%; transform: translateY(-50%); background: none; border: none; cursor: pointer; color: var(--text-secondary); padding: 0; transition: color 0.3s ease;"
              onmouseover="this.style.color='var(--primary)'"
              onmouseout="this.style.color='var(--text-secondary)'"
            >
              <i class="fas fa-eye"></i>
            </button>
          </div>
        </div>

        <div style="display: flex; justify-content: space-between; align-items: center; margin: 1rem 0;">
          <label style="display: flex; align-items: center; gap: 8px; font-size: 0.9rem; color: var(--text-secondary);">
            <input type="checkbox" name="remember" style="accent-color: var(--primary);">
            Remember me
          </label>
          <a href="#" style="color: var(--primary); font-size: 0.9rem; font-weight: 500;">Forgot password?</a>
        </div>

        <button type="submit" class="btn-primary w-full" id="loginBtn">
          <i class="fas fa-sign-in-alt"></i>
          Sign In
        </button>

        <div style="text-align: center; margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid var(--border);">
          <p style="color: var(--text-secondary); font-size: 0.9rem;">
            Don't have an account?
            <a href="{{ url_for('register') }}" style="color: var(--primary); font-weight: 600; text-decoration: none;">
              Create one now
            </a>
          </p>
        </div>

      </form>

      <!-- Demo Credentials -->
      <div style="margin-top: 2rem; padding: 1rem; background: var(--primary-light); border-radius: 12px; border-left: 4px solid var(--primary);">
        <h4 style="font-size: 0.9rem; font-weight: 600; margin-bottom: 0.5rem; color: var(--primary-dark);">
          <i class="fas fa-info-circle"></i> Demo Credentials
        </h4>
        <div style="font-size: 0.8rem; color: var(--text-secondary);">
          <p><strong>Admin:</strong> admin@tiffintrack.com / admin123</p>
          <p><strong>Customer:</strong> Register a new account</p>
        </div>
      </div>

    </div>

  </div>
</section>

<script>
  function togglePassword(inputId, button) {
    const input = document.getElementById(inputId);
    const icon = button.querySelector('i');
    
    if (input.type === 'password') {
      input.type = 'text';
      icon.classList.remove('fa-eye');
      icon.classList.add('fa-eye-slash');
    } else {
      input.type = 'password';
      icon.classList.remove('fa-eye-slash');
      icon.classList.add('fa-eye');
    }
  }

  // Form submission with loading state
  document.getElementById('loginForm').addEventListener('submit', function(e) {
    const btn = document.getElementById('loginBtn');
    btn.innerHTML = '<div class="loading"></div> Signing in...';
    btn.disabled = true;
  });

  // Auto-hide flash messages
  setTimeout(() => {
    const flashMessages = document.querySelectorAll('.flash-message');
    flashMessages.forEach(msg => {
      msg.style.animation = 'slideOut 0.3s ease-out forwards';
      setTimeout(() => msg.remove(), 300);
    });
  }, 5000);
</script>

<style>
@keyframes slideOut {
  to {
    opacity: 0;
    transform: translateX(100%);
  }
}
</style>

</body>
</html>
